---
title: 'HW: Binomial Distribution'
author: "Kris Gunsalus"
date: "9/29/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Binomial distribution (Example 1)

During the industrial revolution in England, London become covered in a lot of black soot from burning coal. Five years beforehand, the proportion of white moths that could be found in London was 87%.[^1] However black moths gained a survival advantage as the air became more polluted. 

If you were to sample moths in London 25 years into the industrial revolution, and you found that 35 out of 50 moths were white, how likely would that be if the population had remained the same?

You can compute the probability of finding _**exactly**_ 35/50: (Answer: 0.088%)

$$ P(X = 35) = {50 \choose 35} 0.87^{35}(1-.87)^{50-35} $$

Which R function should we use to compute this probability, and what is it?

```{r}
# PDF
dbinom(35,size=50,prob=0.87)

# CDF
pbinom(35,size=50,prob=0.87) - pbinom(34,size=50,prob=0.87) 
```

Really what you are probably more interested in is finding out how likely it is that you only found _**no more than**_ 35 in total. To do this, you'd have to add up all the probabilities of getting 0, 1, 2, ... 35 white moths. This is given by the binomial CDF:

$$ P(X \le 35) = \sum_{x_i \le 35}f(x_i)
= \sum_{x_i \le 35}{50 \choose x_i}0.87^{x_i}(1-0.87)^{50-x_i} $$

Wow, that looks nasty! You could use a loop to compute this in R:
```{r}
cdf <- function(x,n,p) {
  result = numeric()
  for (i in 0:x) {
    f = n-i
    q = 1-p
    result[i] = choose(n,i)*(p^i)*(q^f) # bogdan suggests changing this to dbinom()
  }
  return(sum(result))
}
cdf(35,50,0.87)
```

... but the R function for the binomial CDF is so much simpler! It is:
```{r}
pbinom(35,50,0.87) # cumulative probability for x between 0 and 35
```

It's hard to tell from just one sample what the true proportion really is ... we will talk a lot more about this soon! For now, we can estimate how likely it would be that you would find, say, somewhere between 30-40 white moths, vs. 40-50, if the population had not changed:
```{r}
sum(dbinom(30:40,50,0.87))  # very unlikely!
sum(dbinom(40:50,50,0.87))  # much more likely
```

To find the probability of getting 40 or more white moths if the population had stayed the same, i.e. $P(X \ge 40)$, you could also use the CDF. You'd have to add `lower.tail = FALSE` and use 39 instead of 40, or else you would be asking for $P(X > 40)$:
```{r}
pbinom(39,50,0.87,lower.tail=FALSE)
```

We can visualize the density and the CDF by plotting them, which makes it a lot easier to understand the probabilities we computed above:
```{r}
par(mfrow=c(1,2))
x = 0:50
plot(x,dbinom(x,size=50,prob=0.87),type="h",main="PDF",
     xlab="number of successes",ylab="point probability")
plot(x,pbinom(x,size=50,prob=0.87),type="h",main="CDF",
     xlab="number of successes",ylab="total probability")
```


## 2. Wnt signaling: Binomial proportions

Proliferation of embryonic stem cells is important for early development and is promoted by Wnt signaling, which promotes cell cycle progression through the transcriptional activator beta-catenin. In a study of the developing mouse, it was found that only 11% of cells in a region of the brain that is rich in neuronal progenitors was responsive to Wnt (even though Wnt is required for stem cell expansion).

**Note:** You may find the `choose()` function to be useful for parts of this question.

a. If you were to perform FACS on cells from this region that are labeled with a fluorescent antibody against the Wnt receptor, what is the probability of observing the following outcomes among a sample of 6 cells? Below, let's call Wnt-responsive cells = W and Wnt-insensitive cells = I.

```{r}
W = 0.11
I = 0.89

# 1. A sequence of WWIIII
W*W*I*I*I*I

# 2. A sequence of IIWWII
W^2 * I^4

# 3. A string of WWWWWW
W^6

# 4. At least one W cell out of 6
1 - I^6
```

b. How many ways are there to get four Wnt-insensitive cells out of 6 total? (This is the same as the number of ways to get two W cells out of 6.)
```{r}
choose(6,4)
```

c. What is the total probability of getting exactly 4 I cells and 2 W cells in your sample, taking into account all the different ways that this outcome can be obtained?
```{r}
choose(6,4)*W^2 * I^4
```

d. What would be the probability of getting 2 or less W cells in a sample? (Consider the probability of getting either 0, 1, or 2 W cells.)
```{r}
choose(6,0) * W^0 * I^6 + 
choose(6,1) * W^1 * I^5 + 
choose(6,2) * W^2 * I^4
```


[^1]: Disclaimer: I made this up, but based on a true story (see https://en.wikipedia.org/wiki/Peppered_moth_evolution).