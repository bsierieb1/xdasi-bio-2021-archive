---
title: "Rplots"
author: "Manpreet S. Katari"
date: "9/9/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#R plots

In this section we will go over the basic R graphics functions. They are simple yet powerful and can be used to create high quality publication ready images. Note that later on we will go over **ggplots** which will take our graphics to the next level.

### Packages

+ The package we will be using is a part of the base package called “graphics”
+ Packages will often come with their own plotting functions but generally the arguments are the same

### Choosing a graphical output device

+ In the R GUI, as a default, plots will be printed in a new window.
+ On a windows machine it is actually a device called "windows". On a mac it is called "quartz"
+ Different devices include: PDF, PostScript, bitmap, jpeg, png, and LaTeX.
  + These devices will not print to the GUI, instead they will save a file in the working directory.
  
```{r}
#open a new window
#windows() #on a pc
quartz() #on a mac
#current device
dev.cur()
```

```{r}
#start pdf device
pdf()
#list of devices
dev.list()
```

```{r}
#select a device
dev.set(3)
#end a device or close a file
dev.off()

```

### Generating graphics with Plot

+ The output of the function depends on the object it
is passed.
+ ldeaths is an object of class “ts” (time series) that
is provided in R. It is the number of deaths in UK
from 1974-1979 due to lung disease. Since it is a
numerical vector the plot function plots a line.

```{r}
plot(ldeaths)
```

### **par** allows you to set or get Graphical Arguments
+ ann – allow annotation [boolean]
+ bty – plot border type
+ cex – scaling of point size and text
+ cex.axis – scaling of axis label text size
+ cex.lab – scaling of axis title text size
+ cex.main – scaling of plot title text size
+ col – default color plotting
  + also col.axis, col.lab, col.main, col.sub
+ family – font family(arial, courier,etc)
+ font – Font selection (bold, italic, etc)
  + font.axis, font.lab, font.main, font.sub
  
### More useful graphical arguments

+ lab – number of tick marks on each axis
+ las – orientation of axes labels
+ lty – line type (dashed, solid, dotted,etc)
+ lwd – line width
+ mfrow – number of plots to be drawn in a window (also mfcol)
+ pch – style of points (circle, cross, start, etc)
+ tck – draw gridlines of tick marks
+ xaxt/yaxt - Plot x or y tick marks and labels

### Multiple plots in the same device

+ The mfrow argument in the par() function allows you to define the number of rows and columns you want in the device.

+ Every time the plot it will fill the device. If plot is called more then the number of plots then a new window is opened with the same mfrow options.

### Types of plots

+ "p" – points
+ "l" – lines
+ "b" – both – lines and points
+ "c" – lines but not where points are
+ "o" – non overlapping points and lines
+ "h" – histogram-like vertical lines
+ "s" – draw lines as steps
+ "n" – draw only axes.

```{r}
par(mfrow = c(2,2))
plot(ldeaths, type="p")
plot(ldeaths, type="l")
plot(ldeaths, type="h")
plot(ldeaths, type="s")

```

Adding to a plot using functions

+ axis() – add an axis
+ title() – add a title and subtitle
+ legend() – add a legend
+ text() – add text such as point labels
+ points() – add new points to a plot
+ lines() – draw lines specified by points provided as argument
+ polygon() – draw polygon given the coordinates
+ abline() – draw a diagonal, horizontal, or vertical line

```{r}
plot(c(124,118,130,127,103,141,114),
      c(75,80,95,77,68,105,84), 
      xlab="systolic",
      ylab="diastolic", 
      xlim=c(90,150), 
      ylim=c(60,110)
      )

text(c(124,118,130,127,103,141,114),
     c(75,80,95,77,68,105,84),
     labels=c("A","B","C","D","E","F","G"), 
     pos=2)

title(main="Arterial pressure measurements")
axis(side=1, col="blue", tck=1, lty="dotted")
axis(side=2, col="green", tck=1, lty="dotted")

```

### Some Common Plots

+ Pie charts are useful in visualizing proportion of a given category

```{r}
sampleData.df = data.frame(Control=sample(20,4),
                           Nitrogen=sample(20,4),
                           Phospate=sample(20,4))
rownames(sampleData.df)=c("GeneA","GeneB","GeneC", "GeneD")
pie(sampleData.df[,"Control"], labels = rownames(sampleData.df))
```

+ Bar plots are the most common plots and are useful for comparing data values. More complex bar plots can show the different factors that contribute to the value.

```{r}
barplot(as.matrix(sampleData.df))
barplot(as.matrix(sampleData.df), beside = T, col = rainbow(4))
```
+ Boxplots (or box and whisker plots) allow you to compare the median and quartiles of the data sets.

```{r}
boxplot(sampleData.df)
```

+ Histograms help visualize the distribution of the data values. One can think of them as a barplot of the frequency table.
```{r}
hist(as.matrix(sampleData.df))
```
