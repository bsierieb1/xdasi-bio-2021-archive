---
title: "Mouse genes"
author: "Kris Gunsalus"
date: "9/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


This dataset contains protein coding genes from the mouse genome along with their chromosomal coordinates and GC content. 

*Note: Non-standard chromosomes and ~1000 genes 200kb and longer have been removed to make the data easier to work with*


## 0. Load required libraries (ggplot and dplyr)
```{r}
library(ggplot2)
# install.packages("dplyr") # only do this once
library(dplyr)
```


## 1.Import the "mousegenes.csv" file into an object called 'mgenes' and take a look at it.
```{r}
mgenes = read.csv("mouse_genes.csv", stringsAsFactors = FALSE)
str(mgenes)
```


## 2. Add a column called 'Gene_Length_kb' containing gene lengths. To make it easier to read, convert the lengths to kilobases, and round to the nearest integer. Take a look at the resulting data frame.

```{r}


```


## 3. Use ggplot to make a histogram of gene lengths.

+ make the bars a lighter color, add a black border to them, and add some transparency
+ try different bin widths (something between 1 and 10 looks good to me)
+ align the bars to the right of x=0 using `boundary = 0, closed = "left"`
  + this sets the left-most edge of the bars at x=0, and 
  + includes the left boundary in the bin (default is "right")
+ add axis labels

After you are happy with the graph, store it in an object called "mgenes_hist" and take a look at it.

```{r}


```


## 4. Add some vertical lines to the  "genes_hist" graph using `geom_vline()`:

+ a dashed red line showing the the mean length (add color plus `linetype="dashed"`)
+ a solid red line showing the median length

Now take a look at the graph again. Do these data look skewed?

```{r}


```


## 5. Add text labels to the lines calling them "mean" and "median".

```{r}
mgenes_hist = mgenes_hist +
  
  geom_text(aes(x=  , # add this
                y=3000, label="Median"),
            color="blue", angle=90, vjust = 1.5) +
  
  geom_text(aes(x= , # add this
                y=3000, label="Mean"),
            color="blue", angle=90, vjust = 1.5)
mgenes_hist
```


## 6. Use the `summary()` and `IQR()` function to find the IQR of gene lengths, and make a boxplot of gene lengths.

```{r}


```


## 7. Remove the outliers and recalculate the mean and the median of gene lengths again.

+ Use `summary()` to get a vector of stats for the distribution and call it something short for convenience.
+ Then compute the min and max values
+ Use these to make a small dataframe that contains only the data between these values
+ Finally, compute the mean and median

```{r}
# set x to the `summary()` of mgenes$Gene_Length_kb for convenience below
# x is now a vector of stats for the distribution
x = summary(mgenes$Gene_Length_kb)

# calculate the highest and lowest values that are not outliers
# hint: where do the whiskers typically end on a boxplot?
min_len = x["1st Qu."] - 1.5*IQR(mgenes$Gene_Length_kb) # just the min val here
max_len = x[5] + 1.5*IQR(mgenes$Gene_Length_kb)
c(min_len,max_len)

# get trimmed data using base R
trimmed = 

# OR, get trimmed data use dplyr
#library(dplyr)
trimmed = 
  
# mean and median of trimmed data

```


## 8. Add the same kind of mean and median vlines for the data without outliers to "mgenes_hist", using a reddish color
```{r}
mgenes_hist +
  
```


## 9. Look at the variation in gene lengths among chromosomes by generating a ggplot containing separate boxplots for each chromosome. Add some horizontal lines showing the limits of the IQR for all genes together.

```{r}
ggplot(  ) +  # data and aes
           +  # add geom for boxplot
  
  # upper and lower quartiles of the whole dataset
  geom_hline(data = mgenes, 
             aes(yintercept = summary(mgenes$Gene_Length_kb)["3rd Qu."]),
             color="black", linetype="dashed") +
  geom_hline(data = mgenes, 
             aes(yintercept = summary(mgenes$Gene_Length_kb)[2]),
             color="black", linetype="dashed")
```


## 10. Make a bar chart of the total number of genes on each chromosome. Sort them from low to high.

```{r}
# dplyr
genes_per_chr = mgenes %>% group_by(Chr) %>% 
  summarise(max_gene_length = max(Gene_Length_kb)) %>%
  arrange(max_gene_length)
head(genes_per_chr)

# make the plot using `geom_col()`


```

## 11. Make a scatter chart of the total number of genes on each chromosome. Sort them from low to high, and add some nicer labels 

```{r}
# by chr length
chr_length = mgenes %>% group_by(Chr) %>% 
  summarise(chr_size = max(End)) %>% 
  mutate(name=factor(Chr, levels=Chr))

# make the plot


```


## 12. SD and CV

Calculate the standard deviation for gene lengths and gene GC-content. 

Then calculate the coefficient of variation by hand, and compare the variation in gene lengths with the variation in gene GC-content. Which one is more variable?

```{r}
# sd


# cv - what is this?


```

